#' calibrate_lst
#'
#' This function calibrates a list of tests and put results into a summary file
#' in 'results' folder with 'itn' and #run in name.
#'
#' @param dataLst List of response dataframe. Default is NULL (reruns after review).
#' If NULL and items need collapsing, put processed data with test name in
#' 'data' folder before running.
#' @param keysLst List of key dataframes. Element names are test names.
#' @param pid Name of candidates' ID variable.
#' @param n_cov Number of covariates before responses.
#' @param run Integer that indicates round of run.
#'
#' @export

calibrate_lst <- function(dataLst=NULL, keysLst, pid, n_cov, run){
  tests <- names(keysLst)

  for (test in tests){
    if (is.null(dataLst)) {
      data <- NULL
    } else {
      data <- dataLst[[test]]
    }
    calibrate(test, data, keysLst[[test]], pid, n_cov)
  }

  read2one('results', tests, 'itn', pasts0('Run_', run))
}
