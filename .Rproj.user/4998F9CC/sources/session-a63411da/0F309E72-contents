#' delta_DIF_dich
#'
#' This function extracts delta statistics for two categories of dichotomous DIF variable.
#'
#' @param test Name of test.
#' @param DIFVar Name of dichotomous DIF variable, e.g., 'gender'.
#' @param quick Whether quick error is needed. Default is TRUE for DIF analysis.
#' @return Dataframe of variables of 'delta.x', 'delta.y'.
#' @examples
#' delta_DIF_dich(test='AHU', DIFVar='ATSI', quick=F)
#' @export

delta_DIF_dich <- function (test, DIFVar, quick = TRUE){
    folder <- paste0("DIF/", DIFVar)

    delta_its <- file_its(folder, test, DIFVar) |>
        mutate(
            delta = as.numeric(str_sub(X1, -8, -1)),
            var = rep(1:2, N_item(folder, test))
        ) |>
        select(var, delta)

    if (quick) {
        delta_its <- delta_its |>
            nest_by(var) |>
            mutate(m = mean(data$delta, na.rm=TRUE)) |>
            unnest(data) |>
            mutate(delta = delta - m) |>
            select(-m) |>
            ungroup()
    }

    delta_its |>
        dplyr::filter(var == 1) |>
        dplyr::rename(delta.x = delta) |>
        cbind(
            delta_its |>
            dplyr::filter(var == 2) |>
            dplyr::rename(delta.y = delta)
        ) |>
        select(-var)
}
